<!DOCTYPE html>
<head>

</head>
<body>

    <div ng-controller="MainCtrl">
        <div class="thumbnail">
            <div class="row" style="margin: 0px">
                <h1 style="text-align: center">Головна сторінка</h1>
                <div class="col-xs-12 col-sm-5 col-md-4 col-lg-4">
                    <div ng-controller="GroupsCtrl">
                        <div ng-init="getGroupTree();"></div>
                        <!--TREE-->
                        <div style="margin-bottom: 10px">
                            <a href="#editLibrary"><button class="btn btn-primary" type="button">Edit mode <span class="glyphicon glyphicon-star" aria-hidden="true"></span></button></a>
                            <a href="#main"><button ng-click="getSkillsByGroup($currentGroup.left_key, $currentGroup.right_key);" class="btn btn-success" type="button"><span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span></button></a>
                            <a ng-if="$user" id="editItemButton" href="#group/{{getSelectGroupID()}}/edit" ng-click=""><button class="btn btn-primary" type="button"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button></a>
                            <button ng-if="$user" ng-controller="ActionsCtrl" ng-click="prepareGroupToRemove($currentGroup.id, $currentGroup.skill_name, 0, $currentGroup.user_id, $user.id);" class="btn btn-danger" type="button"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
                        </div>
                        <div id="tree"></div>
                    </div>
                </div>

                <div class="col-xs-12 col-sm-7 col-md-8 col-lg-8">

                    <div style="margin-bottom: 10px">
                        <div ng-if="$user" class="btn-group">
                            <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown" type="button">Додати <span class="caret"></span></button>
                            <ul class="dropdown-menu">
                                <li><a href="#skill/create">компетенцію</a></li>
                                <li><a href="#group/create">групу</a></li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <a ng-if="$user" class="btn-group" href="#main"><button ng-click="" class="btn btn-primary" type="button">Імпортувати...</button></a>

                            <div class="btn-group">
                                <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown" type="button">Експортувати... <span class="caret"></span></button>
                                <ul class="dropdown-menu">
                                    <li><a href="" ng-click="showProgress = !showProgress; exportAllData('JSON', $currentGroup.id)">в формат JSON</a></li>
                                    <li><a href="" ng-click="showProgress = !showProgress; exportAllData('XLS', $currentGroup.id)">в формат MS Excel</a></li>
                                </ul>
                            </div>
                        </div>

                        <div class="btn-group">
                            <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown" type="button">Вид... <span class="caret"></span></button>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="#main" ng-click="pageView=true">
                                        Сторінки
                                    </a>
                                </li>
                                <li>
                                    <a href="#main" ng-click="pageView=false">
                                        Список
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="progress" ng-show="showProgress">
                        <div class="progress-bar progress-bar-striped active" role = "progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
                            Експорт файлу...
                        </div>
                    </div>

                    <div class="input-group" style="margin-bottom: 10px">
                        <input type="text" class="form-control" type="text" class="form-control" ng-model="search" placeholder="Пошук по назві, користувачу, групі, індикатору...">
                        <div class="input-group-addon">
                            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                        </div>
                    </div>

                    <div ng-controller="SkillsCtrl">

                        <div ng-init="getAllSkills();"></div>

                        <div ng-show="data==null" style="text-align: center">
                            <img src="assets/img/loading.gif"  width="120px" heidht ="120px">
                        </div>

                        <div ng-if="pageView">
                            <ul class="pager">
                                <li><a href="">←</a></li>
                                <li><a href="">→</a></li>
                            </ul>
                            <div ng-repeat="item_skill in data | filter : skillsFilter">
                                <div class="thumbnail">
                                    <div class="row padded">
                                        <div class="col-lg-5 col-xs-12">
                                            <h4>{{$index+1}}. <a href="#skill/{{item_skill.id}}/show">{{item_skill.skill_name}}</a></h4>
                                            <p>Група: {{item_skill.path}}</p>
                                            <p>Користувач: {{item_skill.user}}</p>
                                        </div>
                                        <div class="col-lg-5 col-xs-12">
                                            <p ng-if="item_skill.indicators.length != 0">Індикатори:</p>
                                            <div ng-repeat="item_indicator in item_skill.indicators">
                                                <ul>
                                                    <li ng-bind="item_indicator.indicator_name"</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-xs-12">
                                            <div ng-if="$user">
                                                <a href="#skill/{{item_skill.id}}/edit"><button class="btn btn-primary" type="button"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button></a>
                                                <button ng-controller="ActionsCtrl" ng-click="prepareSkillToRemove(item_skill.id, item_skill.skill_name, item_skill.parent_id, item_skill.user_id, $user.id);" class="btn btn-danger" type="button"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <ul class="pager">
                                <li><a href="#">←</a></li>
                                <li><a href="#">→</a></li>
                            </ul>
                        </div>

                        <!--ACTUAL-->
                        <div ng-if="!pageView">
                            <div ng-repeat="item_skill in data | filter : skillFilter">
                                <div class="panel panel-info">
                                    <div class="panel-body" style="padding: 5px">
                                        <div class="row">
                                            <div class="col-lg-10 col-md-12 col-sm-12 col-xs-12">
                                                <h4><span ng-bind="($index+1) + '. '"></span><a href="#skill/{{item_skill.id}}/show"><span ng-bind="item_skill.skill_name"></span></a></h4>
                                            </div>
                                            <div class="col-lg-2 col-md-12 col-sm-12 col-xs-12">
                                                <div ng-if="$user">
                                                    <a href="#skill/{{item_skill.id}}/edit"><button class="btn btn-primary" type="button"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button></a>
                                                    <button ng-controller="ActionsCtrl" ng-click="prepareSkillToRemove(item_skill.id, item_skill.skill_name, item_skill.parent_id, item_skill.user_id, $user.id);" class="btn btn-danger" type="button"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel-footer">
                                        <div class="row">
                                            <p ng-if="item_skill.description" style="margin-left: 15px"><span><b>Опис: </b></span><span ng-bind="item_skill.description"></span></p>
                                            <div class="col-lg-5 col-xs-12">
                                                <p><span><b>Група: </b></span><span ng-bind="item_skill.path"></span></p>
                                                <p><span><b>Користувач: </b></span><span ng-bind="item_skill.user"></span></p>
                                            </div>
                                            <div class="col-lg-7 col-xs-12">
                                                <p ng-if="item_skill.indicators.length != 0"><b>Індикатори:</b></p>
                                                <div ng-repeat="item_indicator in item_skill.indicators">
                                                    <ul>
                                                        <li><a href="#skill/{{item_skill.id}}/indicator/{{item_indicator.id}}/show"><span ng-bind="item_indicator.indicator_name"></span></a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div ng-if="data.length == 0">
                            <h4>Компетенцій по даному критерію не знайдено...</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
